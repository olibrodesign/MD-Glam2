<section id="section--{{ section.id }}" {% if section.settings.bg_img != blank %}
    style="background-image: url('{{section.settings.bg_img | img_url: 'master'}}')"
{% endif %}>
    <div class="review-slider--wrapper page-width">
        {% if section.settings.title != blank %}
            <h2 class="title lg--f2 ff-heading sm--f40 uppercase" style="{% unless section.settings.uppercase %}
                text-transform: unset!important;
            {% endunless %}">{{ section.settings.title }}</h2>
        {% endif %}
        {% if section.settings.subtitle != blank %}
            <h5 class="subtitle ff-body">{{ section.settings.subtitle }}</h5>
        {% endif %}
        <div class="slider--wrapper">
            <div class="slider--content">
                {% for block in section.blocks %}
                    <div class="review-slider--item">
                        <div class="image--wrapper">
                            {% if block.settings.before_image != blank %}
                                <div class="before_image">
                                    <img src="{{ block.settings.before_image | img_url: '400x400'}}" alt="{{ block.settings.before_image.alt | escape }}">
                                    <span>Before</span>
                                </div>
                            {% endif %}
                            {% if block.settings.after_image != blank %}
                                <div class="after_image">
                                    <img src="{{ block.settings.after_image | img_url: '400x400'}}" alt="{{ block.settings.after_image.alt | escape }}">
                                    <span>Now</span>
                                </div>
                            {% endif %}
                        </div>
                        <div class="data--wrapper"> 
                            {% if block.settings.reviewer != blank %}
                                <h5 class="reviewer ff-body">{{ block.settings.reviewer }}</h5>
                            {% endif %}
                            <div class="star-date--wrapper">
                                {% for I in (1..5) %}
                                    {% if I > block.settings.star_count %}
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M10.1902 5.34434L10.3066 5.58005L10.5667 5.61786L15.4641 6.32953L11.92 9.7839L11.7318 9.96738L11.7762 10.2265L12.6129 15.1042L8.23266 12.8012L7.99999 12.6789L7.76731 12.8012L3.38694 15.1041L4.22336 10.2265L4.26778 9.96739L4.07957 9.78392L0.535916 6.32953L5.4332 5.61789L5.69332 5.58009L5.80966 5.34438L8.00001 0.906534L10.1902 5.34434ZM3.37625 15.1665C3.37624 15.1665 3.37624 15.1665 3.37624 15.1665L3.37625 15.1665ZM0.490573 6.28533C0.490588 6.28534 0.490603 6.28536 0.490619 6.28537L0.490573 6.28533ZM0.473357 6.33862C0.473318 6.33862 0.473279 6.33863 0.473239 6.33864L0.468754 6.30777L0.473241 6.33864L0.473357 6.33862Z" stroke="black"/>
                                        </svg>
                                        {% else %}
                                        <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M15.979 6.16358C15.9239 5.99384 15.7772 5.87017 15.6006 5.84451L10.6399 5.12364L8.4214 0.628501C8.34242 0.468481 8.17946 0.367188 8.001 0.367188C7.82257 0.367188 7.65959 0.468512 7.58061 0.628501L5.36196 5.12367L0.401389 5.84451C0.224805 5.87017 0.0780998 5.99387 0.0229681 6.16358C-0.0321949 6.33329 0.0138107 6.51959 0.141576 6.64414L3.73101 10.1432L2.88379 15.0839C2.85363 15.2597 2.92595 15.4375 3.07031 15.5423C3.21464 15.6472 3.40597 15.6611 3.56402 15.578L8.00097 13.2454L12.4378 15.5781C12.5064 15.6141 12.5813 15.6319 12.6559 15.6319C12.7531 15.6319 12.8499 15.6017 12.9315 15.5424C13.0759 15.4375 13.1482 15.2598 13.118 15.0839L12.2706 10.1432L15.8604 6.64417C15.9882 6.51959 16.0342 6.33329 15.979 6.16358Z" fill="black"/>
                                        </svg>
                                    {% endif %}
                                 {% endfor %}
                                {% if block.settings.date != blank %}
                                    <span class="date ff-body ">{{block.settings.date}}</span>
                                {% endif %}
                            </div>
                            <div class="data--table">
                                {% if block.settings.age != blank %}
                                    <div class="age--content">
                                        <p class="age--header ff-body">Age</p>
                                        <p class="age--body ff-body">{{ block.settings.age }}</p>
                                    </div>
                                {% endif %}
                                {% if block.settings.skin_type != blank %}
                                    <div class="type--content">
                                        <p class="type--header ff-body">Skin Type</p>
                                        <p class="type--body ff-body">{{ block.settings.skin_type }}</p>
                                    </div>
                                {% endif %}
                                {% if block.settings.skin_concerns != blank %}
                                    <div class="concerns--content">
                                        <p class="concerns--header ff-body">What are your skin concerns?</p>
                                        <p class="concerns--body ff-body">{{ block.settings.skin_concerns }}</p>
                                    </div>
                                {% endif %}
                            </div>
                            {% if block.settings.description != blank %}
                                <div class="description ff-body fs--body">
                                    {{ block.settings.description }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
            <div class="item--count md--hide sm--hide">
                <span class="position">1</span>/<span>{{ section.blocks.size }}</span>
            </div>
            <div class="scroll-bar"><div class="scroll-tumb"></div></div>
            <div class="scroll-button">
                <img class="prev_btn" src="{{'prev_btn.png' | asset_url }}">
                <img class="next_btn" src="{{'next_btn.png' | asset_url }}">
            </div>
            <div class="switch--photos__tap ff-body lg--hide"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 18">
                <path id="cached_FILL0_wght400_GRAD0_opsz48" d="M14.114,26.1a8.313,8.313,0,0,1-6.171-2.658A8.778,8.778,0,0,1,5.357,17.1V15.834l-2.189,2.25L2.1,16.987,6.178,12.8l4.078,4.191-1.067,1.1L7,15.834V17.1a7.138,7.138,0,0,0,2.094,5.161,6.758,6.758,0,0,0,5.022,2.152,7.753,7.753,0,0,0,1.505-.141,6.242,6.242,0,0,0,1.341-.422l1.177,1.209a7.539,7.539,0,0,1-1.984.8A8.728,8.728,0,0,1,14.114,26.1Zm7.909-4.753-4.078-4.191,1.095-1.125L21.2,18.253V17.1a7.138,7.138,0,0,0-2.093-5.161,6.758,6.758,0,0,0-5.022-2.152,7.071,7.071,0,0,0-1.505.155,10.794,10.794,0,0,0-1.341.38L10.064,9.112a7.183,7.183,0,0,1,1.984-.787A9.249,9.249,0,0,1,14.086,8.1a8.313,8.313,0,0,1,6.171,2.658A8.778,8.778,0,0,1,22.843,17.1v1.209l2.189-2.25,1.067,1.1Z" transform="translate(-2.1 -8.1)" fill="#f2a7a0"/>
              </svg>
              Tap to switch photos</div>
        </div>
    </div>
</section>
<style>
    #section--{{section.id}} {
        padding-top: {{ section.settings.padding_top }}px;
        padding-bottom: {{ section.settings.padding_bottom}}px;
    }
    @media (max-width: 1024px) {
        #section--{{section.id}} {
            padding-top: {{ section.settings.padding_top | times: 0.7 }}px;
            padding-bottom: {{ section.settings.padding_bottom | times: 0.7}}px;
        }
    }
    @media (max-width: 767px) {
        #section--{{section.id}} {
            padding-top: {{ section.settings.padding_top_mobile }}px;
            padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
        }
    }
</style>
<script>
    var reviewSlider = function() {
        const prev_btn = document.querySelector('#section--{{ section.id }} .scroll-button .prev_btn');
        const next_btn = document.querySelector('#section--{{ section.id }} .scroll-button .next_btn');
        const scroll_content = document.querySelector('#section--{{ section.id }} .slider--content');
        const image_content = document.querySelector('#section--{{ section.id }} .image--wrapper');
        const tap_btn = document.querySelector('#section--{{ section.id }} .switch--photos__tap');
        const scroll_content_width = scroll_content.offsetWidth;
        const count = document.querySelector('#section--{{ section.id }} .item--count .position');
        var scroll_position = 0;
        const device_width = document.querySelector('body').offsetWidth;
        const item_width = document.querySelector('#section--{{ section.id }} .review-slider--item').offsetWidth;
        const scroll_bar_width = document.querySelector('#section--{{ section.id }} .scroll-bar').offsetWidth;
        const scroll_tumb_width = scroll_bar_width / {{ section.blocks.size }};
        const scroll_tumb = document.querySelector('#section--{{ section.id }} .scroll-tumb')
        scroll_tumb.style.cssText += 'width: '+scroll_tumb_width+'px';
        scroll_content.on('scroll', event=> {
            scroll_position = scroll_content.scrollLeft;
            const num = Math.floor((scroll_position + item_width * 0.5) / item_width) + 1;
            if (num > {{section.blocks.size}}) {
                num = num - 1;
            }
            count.innerHTML = num;
            var margin_tumb = (num-1) * scroll_tumb_width;
            scroll_tumb.style.cssText += 'margin-left: '+margin_tumb+'px';
        })
        prev_btn.on('click', event=> {
            scroll_content.scrollTo({
              top: 0,
              left: scroll_position - (item_width+20),
              behavior: 'smooth'
            });
        })
        next_btn.on('click', event=> {
            scroll_content.scrollTo({
              top: 0,
              left: scroll_position + item_width+20,
              behavior: 'smooth'
            });  
        })
        tap_btn.on('click', event=> {
            image_content.classList.toggle('active')
        })
    }
   
    reviewSlider();
</script>
{% schema %}
    {
        "name": "Review slider",
        "class": "review-slider",
        "settings": [
            {
                "type": "text",
                "id": "title",
                "label": "Title"
            },
            {
                "type": "checkbox",
                "id": "uppercase",
                "label": "Text uppercase",
                "default": true
            },
            {
                "type": "text",
                "id": "subtitle",
                "label": "Subtitle"
            },
            {
                "type": "image_picker",
                "id": "bg_img",
                "label": "Background image"
            },
            {
                "type": "header",
                "content": "Padding on desktop",
                "info": "You can adjust the padding on desktop"
            },
            {
                "type": "range",
                "id": "padding_top",
                "min": 0,
                "max": 200,
                "step": 10,
                "unit": "px",
                "label": "Top Padding",
                "default": 50
            },
            {
                "type": "range",
                "id": "padding_bottom",
                "min": 0,
                "max": 200,
                "step": 10,
                "unit": "px",
                "label": "Bottom Padding",
                "default": 50
            },
            {
                "type": "header",
                "content": "Padding on mobile",
                "info": "You can adjust the padding on mobile"
            },
            {
                "type": "range",
                "id": "padding_top_mobile",
                "min": 0,
                "max": 200,
                "step": 10,
                "unit": "px",
                "label": "Top Padding",
                "default": 20
            },
            {
                "type": "range",
                "id": "padding_bottom_mobile",
                "min": 0,
                "max": 200,
                "step": 10,
                "unit": "px",
                "label": "Bottom Padding",
                "default": 20
            }
        ],
        "blocks": [
            {
                "type": "review",
                "name": "Review item",
                "settings": [
                    {
                        "type": "image_picker",
                        "id": "before_image",
                        "label": "Before image"
                    },
                    {
                        "type": "image_picker",
                        "id": "after_image",
                        "label": "After image"
                    },
                    {
                        "type": "text",
                        "id": "reviewer",
                        "label": "Reviewer"
                    },
                    {
                        "type": "range",
                        "id": "star_count",
                        "min": 0,
                        "max": 5,
                        "step": 1,
                        "unit": "N",
                        "label": "Star count",
                        "default": 5
                    },
                    {
                        "type": "text",
                        "id": "date",
                        "label": "Date"
                    },
                    {
                        "type": "text",
                        "id": "age",
                        "label": "Age"
                    },
                    {
                        "type": "text",
                        "id": "skin_type",
                        "label": "Skin type"
                    },
                    {
                        "type": "text",
                        "id": "skin_concerns",
                        "label": "Skin concerns"
                    },
                    {
                        "type": "richtext",
                        "id": "description",
                        "label": "Description"
                    }
                ]
            }
        ],
        "presets": [
            {
                "name": "Review slider"
            }
        ]
    }
{% endschema %}
